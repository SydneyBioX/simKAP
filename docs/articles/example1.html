<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vignette Title • KidneyAllocation</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Vignette Title">
<meta property="og:description" content="KidneyAllocation">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">KidneyAllocation</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/KidneyAllocation.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/example1%20copy.html">Vignette Title</a>
    </li>
    <li>
      <a href="../articles/example1.html">Vignette Title</a>
    </li>
    <li>
      <a href="../articles/example2.html">example2</a>
    </li>
    <li>
      <a href="../articles/example3.html">Case study for different selection pools</a>
    </li>
    <li>
      <a href="../articles/example4.html">Case study for different selection pools</a>
    </li>
    <li>
      <a href="../articles/example5.html">Case study for different selection pools</a>
    </li>
    <li>
      <a href="../articles/results-Anne/Result%20plots.html">Plots</a>
    </li>
    <li>
      <a href="../articles/results-Anne/results.html">Vignette Title</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="example1_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="example1_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Vignette Title</h1>
                        <h4 class="author">Vignette Author</h4>
            
            <h4 class="date">2021-01-15</h4>
      
      
      <div class="hidden name"><code>example1.Rmd</code></div>

    </div>

    
    
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>data</h2>
<p>data : load metadata</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"KidneyAllocation"</span><span class="op">)</span>
<span class="co">#&gt; Installing package into '/private/var/folders/65/twhcxzg92xjdwdq7mc9xqvlc0000gp/T/RtmprSn0IY/temp_libpath212f15ec93f5'</span>
<span class="co">#&gt; (as 'lib' is unspecified)</span>
<span class="co">#&gt; Warning: package 'KidneyAllocation' is not available (for R version 4.0.2)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"Rtools"</span><span class="op">)</span>
<span class="co">#&gt; Installing package into '/private/var/folders/65/twhcxzg92xjdwdq7mc9xqvlc0000gp/T/RtmprSn0IY/temp_libpath212f15ec93f5'</span>
<span class="co">#&gt; (as 'lib' is unspecified)</span>
<span class="co">#&gt; Warning: package 'Rtools' is not available (for R version 4.0.2)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">KidneyAllocation</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"rawdata"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"newdata"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">rawdata</span><span class="op">)</span>
<span class="co">#&gt; [1] 5945   80</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">raw_donor_matrix</span><span class="op">)</span>
<span class="co">#&gt; [1] 2835   28</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">)</span>
<span class="co">#&gt; [1] 5821   49</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">)</span> <span class="co">#this is one example with weighted sampling according to wl proportion</span>
<span class="co">#&gt; [1] 1477   49</span></code></pre></div>
<p>wl proportion according to annual report</p>
<p>the annual report proportion</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pra_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">rawdata</span><span class="op">$</span><span class="va">recip_pra</span>,
                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>,
                 include.lowest <span class="op">=</span> <span class="cn">TRUE</span>,
                 right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pra_group</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">pra_group</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; pra_group</span>
<span class="co">#&gt;   [0,20)  [20,40)  [40,60)  [60,80) [80,100] </span>
<span class="co">#&gt;     0.82     0.05     0.03     0.02     0.05</span>

<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rawdata</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">rawdata</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    A   AB    B    O </span>
<span class="co">#&gt; 0.39 0.05 0.12 0.44</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Previous grafts"</span><span class="op">)</span>
<span class="co">#&gt; Previous grafts</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rawdata</span><span class="op">$</span><span class="va">recip_graftno</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">rawdata</span><span class="op">$</span><span class="va">recip_graftno</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    0    1    2 </span>
<span class="co">#&gt; 0.93 0.07 0.00</span>

<span class="va">age_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">rawdata</span><span class="op">$</span><span class="va">recip_age</span>,
                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">55</span>, <span class="fl">65</span>, <span class="fl">100</span><span class="op">)</span>,
                 include.lowest <span class="op">=</span> <span class="cn">TRUE</span>,
                 right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">age_group</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">age_group</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; age_group</span>
<span class="co">#&gt;   [0,45)  [45,55)  [55,65) [65,100] </span>
<span class="co">#&gt;     0.31     0.25     0.30     0.14</span></code></pre></div>
<p>Pra group</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">raw_recip_matrix</span> <span class="op">&lt;-</span> <span class="va">raw_recip_matrix</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_pra</span><span class="op">)</span>, <span class="op">]</span>

<span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">pra_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_pra</span>,
                                  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>,
                                  include.lowest <span class="op">=</span> <span class="cn">TRUE</span>,
                                  right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Allocation proportion"</span><span class="op">)</span>
<span class="co">#&gt; Allocation proportion</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">pra_group</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">pra_group</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   [0,20)  [20,40)  [40,60)  [60,80) [80,100] </span>
<span class="co">#&gt;     0.84     0.05     0.03     0.02     0.05</span>


<span class="va">pra_group_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.65</span>, <span class="fl">0.09</span>, <span class="fl">0.07</span>, <span class="fl">0.06</span>, <span class="fl">0.13</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">pra_group_prob</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">pra_group</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Waiting list proportion"</span><span class="op">)</span>
<span class="co">#&gt; Waiting list proportion</span>
<span class="va">pra_group_prob</span>
<span class="co">#&gt;   [0,20)  [20,40)  [40,60)  [60,80) [80,100] </span>
<span class="co">#&gt;     0.65     0.09     0.07     0.06     0.13</span></code></pre></div>
<p>Blood group</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Allocation proportion"</span><span class="op">)</span>
<span class="co">#&gt; Allocation proportion</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    A   AB    B    O </span>
<span class="co">#&gt; 0.39 0.05 0.12 0.44</span>

<span class="va">blood_group_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.02</span>, <span class="fl">0.17</span>, <span class="fl">0.51</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">blood_group_prob</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"AB"</span>, <span class="st">"B"</span>, <span class="st">"O"</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Waiting list proportion"</span><span class="op">)</span>
<span class="co">#&gt; Waiting list proportion</span>
<span class="va">blood_group_prob</span>
<span class="co">#&gt;    A   AB    B    O </span>
<span class="co">#&gt; 0.30 0.02 0.17 0.51</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Previous grafts"</span><span class="op">)</span>
<span class="co">#&gt; Previous grafts</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_graftno</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_graftno</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    0    1    2 </span>
<span class="co">#&gt; 0.93 0.07 0.00</span></code></pre></div>
<p>Age group</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_age_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_age</span>,
                                        <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">55</span>, <span class="fl">65</span>, <span class="fl">100</span><span class="op">)</span>,
                                        include.lowest <span class="op">=</span> <span class="cn">TRUE</span>,
                                        right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Allocation proportion"</span><span class="op">)</span>
<span class="co">#&gt; Allocation proportion</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_age_group</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_age_group</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   [0,45)  [45,55)  [55,65) [65,100] </span>
<span class="co">#&gt;     0.31     0.25     0.30     0.14</span></code></pre></div>
<p>State group</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Waiting list proportion"</span><span class="op">)</span>
<span class="co">#&gt; Waiting list proportion</span>
<span class="va">state_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">531</span>, <span class="fl">340</span>, <span class="fl">106</span>, <span class="fl">56</span>, <span class="fl">42</span><span class="op">)</span><span class="op">/</span><span class="fl">1075</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">state_prob</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NSW"</span>, <span class="st">"VIC"</span>, <span class="st">"QLD"</span>, <span class="st">"SA"</span>, <span class="st">"WA"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  NSW  QLD   SA  VIC   WA </span>
<span class="co">#&gt; 0.28 0.20 0.11 0.32 0.08</span></code></pre></div>
</div>
<div id="an-weighted-sampling-example" class="section level2">
<h2 class="hasAnchor">
<a href="#an-weighted-sampling-example" class="anchor"></a>an weighted sampling example</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grid_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="va">pra_group_prob</span>, <span class="va">blood_group_prob</span>, <span class="va">state_prob</span><span class="op">)</span>
<span class="va">grid_prob</span> <span class="op">&lt;-</span> <span class="va">grid_prob</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">grid_prob</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">grid_prob</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>
<span class="va">grid_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">pra_group_prob</span><span class="op">)</span>, 
                               <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">blood_group_prob</span><span class="op">)</span>,
                               <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">state_prob</span><span class="op">)</span><span class="op">)</span>,
                   prob <span class="op">=</span> <span class="va">grid_prob</span><span class="op">)</span>



<span class="va">num_recip_size</span> <span class="op">=</span> <span class="fl">1500</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">202001</span><span class="op">)</span>
<span class="va">grid_prob</span><span class="op">$</span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">grid_prob</span><span class="op">$</span><span class="va">prob</span> <span class="op">*</span> <span class="va">num_recip_size</span><span class="op">)</span>
<span class="va">grid_prob</span><span class="op">$</span><span class="va">Var3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">grid_prob</span><span class="op">$</span><span class="va">Var3</span><span class="op">)</span>
<span class="va">raw_recip_matrix_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">grid_prob</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">raw_recip_matrix</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">recip_blgroup</span> <span class="op">==</span> <span class="va">grid_prob</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span>,
                                     <span class="va">pra_group</span> <span class="op">==</span> <span class="va">grid_prob</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>,
                                     <span class="va">recip_state</span> <span class="op">==</span> <span class="va">grid_prob</span><span class="op">[</span><span class="va">i</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>
  <span class="va">num_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">grid_prob</span><span class="op">[</span><span class="va">i</span>, <span class="fl">5</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">num_tmp</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">raw_recip_matrix_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span>, <span class="va">tmp</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 1477</span>

<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  NSW  QLD   SA  VIC   WA </span>
<span class="co">#&gt; 0.48 0.10 0.05 0.32 0.04</span>



<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    A   AB    B    O </span>
<span class="co">#&gt; 0.31 0.02 0.17 0.51</span>


<span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">pra_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_pra</span>,
                                         <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>,
                                         include.lowest <span class="op">=</span> <span class="cn">TRUE</span>,
                                         right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">pra_group</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">pra_group</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   [0,20)  [20,40)  [40,60)  [60,80) [80,100] </span>
<span class="co">#&gt;     0.66     0.09     0.07     0.06     0.12</span>


<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_waittime</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.0411  2.2685  4.3890  5.0558  7.0767 19.8466</span>

<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_age_group</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   [0,45)  [45,55)  [55,65) [65,100] </span>
<span class="co">#&gt;     0.34     0.25     0.27     0.15</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  NSW  QLD   SA  VIC   WA </span>
<span class="co">#&gt; 0.48 0.10 0.05 0.32 0.04</span></code></pre></div>
</div>
<div id="multiple-weighted-sampling-using-donor-matrix-and-recipient-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-weighted-sampling-using-donor-matrix-and-recipient-matrix" class="anchor"></a>multiple weighted sampling using donor matrix and recipient matrix</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">multiple_sampling_recip_matrix_fun</span><span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">seed</span><span class="op">)</span><span class="op">{</span>
<span class="va">num_recip_size</span> <span class="op">=</span> <span class="fl">1500</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span>
<span class="va">grid_prob</span><span class="op">$</span><span class="va">num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">grid_prob</span><span class="op">$</span><span class="va">prob</span> <span class="op">*</span> <span class="va">num_recip_size</span><span class="op">)</span>
<span class="va">grid_prob</span><span class="op">$</span><span class="va">Var3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">grid_prob</span><span class="op">$</span><span class="va">Var3</span><span class="op">)</span>
<span class="va">raw_recip_matrix_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">grid_prob</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">raw_recip_matrix</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">recip_blgroup</span> <span class="op">==</span> <span class="va">grid_prob</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span>,
                                     <span class="va">pra_group</span> <span class="op">==</span> <span class="va">grid_prob</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span>,
                                     <span class="va">recip_state</span> <span class="op">==</span> <span class="va">grid_prob</span><span class="op">[</span><span class="va">i</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>
  <span class="va">num_tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">grid_prob</span><span class="op">[</span><span class="va">i</span>, <span class="fl">5</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">num_tmp</span><span class="op">)</span>, <span class="op">]</span>
  <span class="va">raw_recip_matrix_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span>, <span class="va">tmp</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">pra_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_pra</span>,
                                         <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">60</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>,
                                         include.lowest <span class="op">=</span> <span class="cn">TRUE</span>,
                                         right <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">pra_group</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">pra_group</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_age_group</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span><span class="op">)</span>
<span class="op">}</span>


<span class="co">#10 times </span>
<span class="va">recip_sample_list</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span>
  <span class="va">recip_sample_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu">multiple_sampling_recip_matrix_fun</span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>10*2 results</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sdm1_fun</span><span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">recip_dt</span><span class="op">)</span><span class="op">{</span>
  <span class="va">result</span><span class="op">=</span><span class="fu"><a href="../reference/runSimulation5.4.html">runSimulation5.4</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span>, 
                                 <span class="va">raw_donor_matrix</span>,
                                 algorithm_FUN <span class="op">=</span> <span class="va">allocation_national</span>,
                                 eligible_FUN <span class="op">=</span> <span class="va">selectionpool1.2</span>,
                                 matching_FUN <span class="op">=</span> <span class="va">dmNational_formula</span>,
                                 waitlist_FUN <span class="op">=</span> <span class="va">dynamic_waitlist</span>,
                                 state_algorithm <span class="op">=</span> <span class="cn">TRUE</span>,
                                 national_algorithm_threshold <span class="op">=</span> <span class="fl">54000000</span>,
                                 state_algorithm_FUN <span class="op">=</span> <span class="va">Australia_state_algorithm</span>,
                                 state_eligible_FUN <span class="op">=</span> <span class="va">Australia_state_selectionpool</span>,
                                 state_matching_FUN <span class="op">=</span> <span class="va">dmState_formula</span>,
                                 eligible_arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>AB_priority <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                                 waitlist_arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>waitlist_Risk <span class="op">=</span> <span class="cn">TRUE</span>,
                                                       rate_in <span class="op">=</span> <span class="fl">0.70</span>,
                                                       rate_out <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span>,
                                 resampleN <span class="op">=</span> <span class="fl">1</span>,
                                 verbose <span class="op">=</span> <span class="cn">FALSE</span>,
                                 num_donor <span class="op">=</span> <span class="fl">800</span>,num_recip <span class="op">=</span> <span class="fl">300</span>,
                                 state_balance <span class="op">=</span> <span class="cn">TRUE</span>,
                                 dynamic_waitlist <span class="op">=</span> <span class="cn">TRUE</span>, 
                                 National_II <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">}</span>


<span class="va">max_selection_fun</span><span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">recip_dt</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="../reference/runSimulation5.4.html">runSimulation5.4</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span>, 
                                   <span class="va">raw_donor_matrix</span>,
                                   algorithm_FUN <span class="op">=</span> <span class="va">allocation_national</span>,
                                   eligible_FUN <span class="op">=</span> <span class="va">selectionpool1.2</span>,
                                   matching_FUN <span class="op">=</span> <span class="va">select_max</span>,
                                   waitlist_FUN <span class="op">=</span> <span class="va">dynamic_waitlist</span>,
                                   state_algorithm <span class="op">=</span> <span class="cn">TRUE</span>,
                                   national_algorithm_threshold <span class="op">=</span> <span class="fl">54000000</span>,
                                   waitlist_arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>waitlist_Risk <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                                   state_algorithm_FUN <span class="op">=</span> <span class="va">Australia_state_algorithm</span>,
                                   state_eligible_FUN <span class="op">=</span> <span class="va">Australia_state_selectionpool</span>,
                                   state_matching_FUN <span class="op">=</span> <span class="va">select_max</span>,
                                   eligible_arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>AB_priority <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                                   resampleN <span class="op">=</span> <span class="fl">1</span>,
                                   verbose <span class="op">=</span> <span class="cn">FALSE</span>,
                                   num_donor <span class="op">=</span> <span class="fl">800</span>,
                                   num_recip <span class="op">=</span> <span class="fl">300</span>, 
                                   state_balance <span class="op">=</span> <span class="cn">TRUE</span>,
                                   dynamic_waitlist <span class="op">=</span> <span class="cn">TRUE</span>, 
                                   National_II <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>


<span class="va">simresult1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">simresult2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span><span class="va">simresult1</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu">sdm1_fun</span><span class="op">(</span><span class="va">recip_sample_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">}</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span><span class="va">simresult2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu">max_selection_fun</span><span class="op">(</span><span class="va">recip_sample_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">simresult1</span>,<span class="st">"simresult1.rds"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">simresult2</span>,<span class="st">"simresult2.rds"</span><span class="op">)</span></code></pre></div>
<div id="plots" class="section level3">
<h3 class="hasAnchor">
<a href="#plots" class="anchor"></a>plots</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simresult1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"simresult2.rds"</span><span class="op">)</span>
<span class="va">simresult2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"simresult1.rds"</span><span class="op">)</span>
<span class="va">sim_state_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">simresult1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">simresult1</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">simresult1</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult1</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult1</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult1</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult1</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult1</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult1</span><span class="op">[[</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult1</span><span class="op">[[</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">sim_state_pref</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">simresult2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">simresult2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">simresult2</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult2</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult2</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult2</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult2</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult2</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult2</span><span class="op">[[</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">simresult2</span><span class="op">[[</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">)</span>
<span class="co">#&gt; [1] 11000</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">donor_id</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 2404</span>

<span class="va">sim_state_subset</span><span class="op">$</span><span class="va">sim_waittime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">-</span> 
                                              <span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_rrtstartdate</span><span class="op">)</span>
<span class="va">sim_state_subset</span><span class="op">$</span><span class="va">sim_listtime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">-</span> 
                                              <span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_sim_listdate</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">)</span>
<span class="co">#&gt; [1] 11159</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">donor_id</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 2455</span>

<span class="va">sim_state_pref</span><span class="op">$</span><span class="va">sim_waittime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">-</span> 
                                              <span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_rrtstartdate</span><span class="op">)</span>
<span class="va">sim_state_pref</span><span class="op">$</span><span class="va">sim_listtime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">-</span> 
                                              <span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_sim_listdate</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">


<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; No id variables; using all as measure variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>recip_listtime <span class="op">=</span> <span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; No id variables; using all as measure variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>


<span class="va">pref_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; No id variables; using all as measure variables</span>
<span class="va">pref_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">pref_df</span><span class="op">$</span><span class="va">variable</span>,
                                    from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span>,
                                    to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pref_sim_listtime"</span>, 
                                           <span class="st">"pref_recip_listtime"</span><span class="op">)</span><span class="op">)</span>


<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span>, <span class="va">pref_df</span><span class="op">)</span>

<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">/</span><span class="fl">365</span>, 
                     color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_color_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"listing time (Year)"</span><span class="op">)</span>

<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">value</span><span class="op">/</span><span class="fl">365</span>, 
                     x <span class="op">=</span> <span class="va">variable</span>,
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (Year)"</span><span class="op">)</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, align <span class="op">=</span> <span class="st">"hv"</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<p>Blood group</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_blgroup"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_blgroup as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_blgroup"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_blgroup as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_blgroup</span>, y <span class="op">=</span> <span class="va">value</span>, 
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"weighted sampling"</span><span class="op">)</span>



<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_blgroup"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_blgroup as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_blgroup"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_blgroup as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>
<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_blgroup</span>, y <span class="op">=</span> <span class="va">value</span>, 
                          fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sdm1"</span><span class="op">)</span>




<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g3</span>,  ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span>, align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<p>Recipient State</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_state"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_state"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_state</span>, y <span class="op">=</span> <span class="va">value</span>, 
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"weighted sampling"</span><span class="op">)</span>





<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_state"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_state"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>
<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_state</span>, y <span class="op">=</span> <span class="va">value</span>, 
                          fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sdm1"</span><span class="op">)</span>




<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g3</span>,ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span><span class="fl">1</span>, align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_state"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span>, <span class="st">"algorithm"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state, algorithm as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_state"</span>, <span class="st">"recip_listtime"</span>, <span class="st">"recip_algorithm"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state, recip_algorithm as id variables</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"algorithm"</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_state</span>, y <span class="op">=</span> <span class="va">value</span>, 
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">algorithm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"weighted sampling"</span><span class="op">)</span>



<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_state"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span>, <span class="st">"algorithm"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state, algorithm as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_state"</span>, <span class="st">"recip_listtime"</span>, <span class="st">"recip_algorithm"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state, recip_algorithm as id variables</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"algorithm"</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>
<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_state</span>, y <span class="op">=</span> <span class="va">value</span>, 
                          fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">algorithm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sdm1"</span><span class="op">)</span>




<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g3</span>,ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span>,
          align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
<p>PRA group</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pra_group"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using pra_group as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"pra_group"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using pra_group as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pra_group</span>, y <span class="op">=</span> <span class="va">value</span>, 
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"weighted sampling"</span><span class="op">)</span>



<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pra_group"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using pra_group as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"pra_group"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using pra_group as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>
<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pra_group</span>, y <span class="op">=</span> <span class="va">value</span>, 
                          fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sdm1"</span><span class="op">)</span>



<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g3</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span>, align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<p>Algorithm Proportions</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="va">d2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"sim"</span><span class="op">)</span>, 
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_algorithm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">)</span>,type<span class="op">=</span> <span class="st">"actual"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">d2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">d2</span>, algorithm<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"type"</span>, <span class="st">"algorithm"</span><span class="op">)</span> 
<span class="va">d2</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">d2</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">g2</span> <span class="op">=</span> <span class="va">d2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">algorithm</span>, y<span class="op">=</span> <span class="va">n</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"Weighted sampling"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> 

<span class="va">d3</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"sim"</span><span class="op">)</span>, 
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_algorithm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">)</span>,type<span class="op">=</span> <span class="st">"actual"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">d3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">d3</span>, algorithm<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">d3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">d3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"type"</span>, <span class="st">"algorithm"</span><span class="op">)</span> 
<span class="va">d3</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">d3</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">=</span> <span class="va">d3</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">algorithm</span>, y<span class="op">=</span> <span class="va">n</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"sdm1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> 



<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g2</span>, <span class="va">g3</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span>,
          align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
</div>
<div id="two-simulation-results" class="section level2">
<h2 class="hasAnchor">
<a href="#two-simulation-results" class="anchor"></a>two simulation results</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#max selection</span>
<span class="va">sim_state_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runSimulation5.4.html">runSimulation5.4</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span>, 
                                   <span class="va">raw_donor_matrix</span>,
                                   algorithm_FUN <span class="op">=</span> <span class="va">allocation_national</span>,
                                   eligible_FUN <span class="op">=</span> <span class="va">selectionpool1.2</span>,
                                   matching_FUN <span class="op">=</span> <span class="va">select_max</span>,
                                   waitlist_FUN <span class="op">=</span> <span class="va">dynamic_waitlist</span>,
                                   state_algorithm <span class="op">=</span> <span class="cn">TRUE</span>,
                                   national_algorithm_threshold <span class="op">=</span> <span class="fl">54000000</span>,
                                   waitlist_arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>waitlist_Risk <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                                   state_algorithm_FUN <span class="op">=</span> <span class="va">Australia_state_algorithm</span>,
                                   state_eligible_FUN <span class="op">=</span> <span class="va">Australia_state_selectionpool</span>,
                                   state_matching_FUN <span class="op">=</span> <span class="va">select_max</span>,
                                   eligible_arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>AB_priority <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                                   resampleN <span class="op">=</span> <span class="fl">1</span>,
                                   verbose <span class="op">=</span> <span class="cn">FALSE</span>,
                                   num_donor <span class="op">=</span> <span class="fl">800</span>,
                                   num_recip <span class="op">=</span> <span class="fl">300</span>, 
                                   state_balance <span class="op">=</span> <span class="cn">TRUE</span>,
                                   dynamic_waitlist <span class="op">=</span> <span class="cn">TRUE</span>, 
                                   National_II <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>


<span class="co">#sdm1</span>
<span class="va">sim_state_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runSimulation5.4.html">runSimulation5.4</a></span><span class="op">(</span><span class="va">raw_recip_matrix_subset</span>, 
                                 <span class="va">raw_donor_matrix</span>,
                                 algorithm_FUN <span class="op">=</span> <span class="va">allocation_national</span>,
                                 eligible_FUN <span class="op">=</span> <span class="va">selectionpool1.2</span>,
                                 matching_FUN <span class="op">=</span> <span class="va">dmNational_formula</span>,
                                 waitlist_FUN <span class="op">=</span> <span class="va">dynamic_waitlist</span>,
                                 state_algorithm <span class="op">=</span> <span class="cn">TRUE</span>,
                                 national_algorithm_threshold <span class="op">=</span> <span class="fl">54000000</span>,
                                 state_algorithm_FUN <span class="op">=</span> <span class="va">Australia_state_algorithm</span>,
                                 state_eligible_FUN <span class="op">=</span> <span class="va">Australia_state_selectionpool</span>,
                                 state_matching_FUN <span class="op">=</span> <span class="va">dmState_formula</span>,
                                 eligible_arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>AB_priority <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
                                 waitlist_arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>waitlist_Risk <span class="op">=</span> <span class="cn">TRUE</span>,
                                                       rate_in <span class="op">=</span> <span class="fl">0.70</span>,
                                                       rate_out <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span>,
                                 resampleN <span class="op">=</span> <span class="fl">1</span>,
                                 verbose <span class="op">=</span> <span class="cn">FALSE</span>,
                                 num_donor <span class="op">=</span> <span class="fl">800</span>,num_recip <span class="op">=</span> <span class="fl">300</span>,
                                 state_balance <span class="op">=</span> <span class="cn">TRUE</span>,
                                 dynamic_waitlist <span class="op">=</span> <span class="cn">TRUE</span>, 
                                 National_II <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
<div id="characteristics" class="section level3">
<h3 class="hasAnchor">
<a href="#characteristics" class="anchor"></a>characteristics</h3>
<p>max selection</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dynamics_matrix_subset</span> <span class="op">&lt;-</span> <span class="va">sim_state_subset</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>


<span class="va">sim_state_subset</span> <span class="op">&lt;-</span> <span class="va">sim_state_subset</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">)</span>
<span class="co">#&gt; [1] 1048</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">donor_id</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] 621</span>

<span class="va">sim_state_subset</span><span class="op">$</span><span class="va">sim_waittime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">-</span> 
                                              <span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_rrtstartdate</span><span class="op">)</span>
<span class="va">sim_state_subset</span><span class="op">$</span><span class="va">sim_listtime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">-</span> 
                                              <span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_sim_listdate</span><span class="op">)</span>
<span class="co"># hla_mismatch &lt;- sim_state_subset[, c("tx_misa", "tx_misb", "tx_misdr")] %&gt;% mutate_if(is.character, as.numeric)</span>
<span class="co"># table(rowSums(hla_mismatch))</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        National National_round2           State </span>
<span class="co">#&gt;             464               6             578</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">donor_blgroup</span>, <span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span>
<span class="co">#&gt;     </span>
<span class="co">#&gt;        A  AB   B   O</span>
<span class="co">#&gt;   A  394   5   0   0</span>
<span class="co">#&gt;   AB   0   7   0   0</span>
<span class="co">#&gt;   B    0   1 106   0</span>
<span class="co">#&gt;   O    3   5   3 524</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">sim_waittime</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>
<span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span class="co">#&gt;  0.03836  2.23836  5.35342  5.64331  8.41096 16.92877</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_waittime</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.1671  2.5938  5.4055  5.8676  7.8356 19.8466</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">sim_listtime</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.0000  0.1699  0.9329  1.8485  2.9685  9.8411</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_listtime</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>
<span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="co">#&gt;  0.005479  0.473973  1.490411  2.233781  3.323288 10.789041</span>

<span class="va">sim_state_subset</span><span class="op">[</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">algorithm</span> <span class="op">==</span> <span class="st">"National_round2"</span>, 
                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"donor_blgroup"</span>, <span class="st">"recip_blgroup"</span>, <span class="st">"score"</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt;       donor_blgroup recip_blgroup            score</span>
<span class="co">#&gt; 93                O             B 55000025.2493151</span>
<span class="co">#&gt; 2051              O             A 55000017.7534247</span>
<span class="co">#&gt; 16512             O             A         55000012</span>
<span class="co">#&gt; 386               O             B  58000091.890411</span>
<span class="co">#&gt; 11353             O             B 56000004.4054795</span>
<span class="co">#&gt; 1711              O             A 55000101.1945205</span>

<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">sim_waittime</span>, <span class="va">rawdata</span><span class="op">$</span><span class="va">recip_waittime</span><span class="op">)</span>
<span class="co">#&gt; Warning in ks.test(sim_state_subset$sim_waittime, rawdata$recip_waittime): p-</span>
<span class="co">#&gt; value will be approximate in the presence of ties</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two-sample Kolmogorov-Smirnov test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  sim_state_subset$sim_waittime and rawdata$recip_waittime</span>
<span class="co">#&gt; D = 0.25516, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: two-sided</span>

<span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_waittime</span><span class="op">/</span><span class="fl">365</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">algorithm</span>,
               <span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>,
          <span class="va">mean</span><span class="op">)</span>
<span class="co">#&gt;            Group.1 Group.2        x</span>
<span class="co">#&gt; 1         National     NSW 5.248849</span>
<span class="co">#&gt; 2  National_round2     NSW 6.473973</span>
<span class="co">#&gt; 3            State     NSW 8.169412</span>
<span class="co">#&gt; 4         National     QLD 5.997634</span>
<span class="co">#&gt; 5  National_round2     QLD 1.720548</span>
<span class="co">#&gt; 6            State     QLD 4.500220</span>
<span class="co">#&gt; 7         National      SA 3.715664</span>
<span class="co">#&gt; 8  National_round2      SA 1.027397</span>
<span class="co">#&gt; 9            State      SA 4.089264</span>
<span class="co">#&gt; 10        National     VIC 5.194051</span>
<span class="co">#&gt; 11 National_round2     VIC 5.861644</span>
<span class="co">#&gt; 12           State     VIC 7.718435</span>
<span class="co">#&gt; 13        National      WA 7.221005</span>
<span class="co">#&gt; 14           State      WA 4.992358</span>

<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">sim_listtime</span>, <span class="va">rawdata</span><span class="op">$</span><span class="va">recip_listtime</span><span class="op">)</span>
<span class="co">#&gt; Warning in ks.test(sim_state_subset$sim_listtime, rawdata$recip_listtime): p-</span>
<span class="co">#&gt; value will be approximate in the presence of ties</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two-sample Kolmogorov-Smirnov test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  sim_state_subset$sim_listtime and rawdata$recip_listtime</span>
<span class="co">#&gt; D = 0.077611, p-value = 4.362e-05</span>
<span class="co">#&gt; alternative hypothesis: two-sided</span>

<span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_listtime</span><span class="op">/</span><span class="fl">365</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">algorithm</span>,
               <span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>,
          <span class="va">mean</span><span class="op">)</span>
<span class="co">#&gt;            Group.1 Group.2         x</span>
<span class="co">#&gt; 1         National     NSW 2.6547260</span>
<span class="co">#&gt; 2  National_round2     NSW 3.3136986</span>
<span class="co">#&gt; 3            State     NSW 2.9907618</span>
<span class="co">#&gt; 4         National     QLD 2.3475716</span>
<span class="co">#&gt; 5  National_round2     QLD 1.4328767</span>
<span class="co">#&gt; 6            State     QLD 1.8279146</span>
<span class="co">#&gt; 7         National      SA 0.5842764</span>
<span class="co">#&gt; 8  National_round2      SA 0.3972603</span>
<span class="co">#&gt; 9            State      SA 1.0491876</span>
<span class="co">#&gt; 10        National     VIC 2.2231101</span>
<span class="co">#&gt; 11 National_round2     VIC 1.8767123</span>
<span class="co">#&gt; 12           State     VIC 2.2041426</span>
<span class="co">#&gt; 13        National      WA 3.5360731</span>
<span class="co">#&gt; 14           State      WA 1.7877433</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; NSW QLD  SA VIC  WA </span>
<span class="co">#&gt; 366 166 110 384  22</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ids</span> <span class="op">&lt;-</span> <span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_id</span> 
<span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">rawdata</span><span class="op">$</span><span class="va">recip_id</span>, <span class="va">rawdata</span><span class="op">$</span><span class="va">recip_graftno</span>, sep <span class="op">=</span> <span class="st">"_"</span> <span class="op">)</span><span class="op">%in%</span> <span class="va">ids</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rawdata</span><span class="op">[</span><span class="va">index</span>,<span class="op">]</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; National    State </span>
<span class="co">#&gt;      205      405</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        National National_round2           State </span>
<span class="co">#&gt;             464               6             578</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dynamics_matrix_subset</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    799 obs. of  7 variables:</span>
<span class="co">#&gt;  $ date      : chr  "2008-11-13" "2008-11-15" "2008-11-24" "2008-11-28" ...</span>
<span class="co">#&gt;  $ donor_id  : chr  "D60436" "D1038026" "D70168" "D1038004" ...</span>
<span class="co">#&gt;  $ num_kidney: chr  "1" "1" "2" "2" ...</span>
<span class="co">#&gt;  $ before    : chr  "298" "317" "314" "310" ...</span>
<span class="co">#&gt;  $ exclude   : chr  "16" "3" "6" "1" ...</span>
<span class="co">#&gt;  $ include   : chr  "36" "1" "4" "1" ...</span>
<span class="co">#&gt;  $ after     : chr  "318" "315" "312" "310" ...</span>
<span class="va">dynamics_matrix_subset</span> <span class="op">&lt;-</span> <span class="va">dynamics_matrix_subset</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">before</span><span class="op">)</span>,after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">after</span><span class="op">)</span>,
                                                        include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">include</span><span class="op">)</span>,exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">exclude</span><span class="op">)</span><span class="op">)</span>
<span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">date</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span> <span class="op">)</span>
<span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">tx_year</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">)</span>

<span class="va">dynamics_matrix_subset</span><span class="op">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tx_date</span>, y<span class="op">=</span> <span class="va">after</span>, colour<span class="op">=</span><span class="va">include</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_count.html">geom_count</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">tx_year</span>, <span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">num_kidney</span><span class="op">)</span> 
<span class="co">#&gt;       </span>
<span class="co">#&gt;          1   2</span>
<span class="co">#&gt;   2008   4   7</span>
<span class="co">#&gt;   2009  15  36</span>
<span class="co">#&gt;   2010  29  41</span>
<span class="co">#&gt;   2011  15  55</span>
<span class="co">#&gt;   2012  20  51</span>
<span class="co">#&gt;   2013  18  53</span>
<span class="co">#&gt;   2014  21  72</span>
<span class="co">#&gt;   2015  32  68</span>
<span class="co">#&gt;   2016  36  85</span>
<span class="co">#&gt;   2017  32 109</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">tx_year</span>, <span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">num_kidney</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">tx_year</span>, <span class="va">dynamics_matrix_subset</span><span class="op">$</span><span class="va">num_kidney</span><span class="op">)</span> <span class="op">)</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;                1         2</span>
<span class="co">#&gt;   2008 0.3636364 0.6363636</span>
<span class="co">#&gt;   2009 0.2941176 0.7058824</span>
<span class="co">#&gt;   2010 0.4142857 0.5857143</span>
<span class="co">#&gt;   2011 0.2142857 0.7857143</span>
<span class="co">#&gt;   2012 0.2816901 0.7183099</span>
<span class="co">#&gt;   2013 0.2535211 0.7464789</span>
<span class="co">#&gt;   2014 0.2258065 0.7741935</span>
<span class="co">#&gt;   2015 0.3200000 0.6800000</span>
<span class="co">#&gt;   2016 0.2975207 0.7024793</span>
<span class="co">#&gt;   2017 0.2269504 0.7730496</span></code></pre></div>
<p>sdm1</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dynamic_matrix_pref</span> <span class="op">&lt;-</span> <span class="va">sim_state_pref</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>
<span class="va">sim_state_pref</span><span class="op">&lt;-</span> <span class="va">sim_state_pref</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">pra_small</span><span class="op">=</span><span class="va">sim_state_pref</span><span class="op">[</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_pra</span><span class="op">&lt;=</span><span class="fl">20</span>,<span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pra_small</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        National National_round2           State </span>
<span class="co">#&gt;             157               9             546</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pra_small</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   A  AB   B   O </span>
<span class="co">#&gt; 241  13  88 370</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pra_small</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; NSW QLD  SA VIC  WA </span>
<span class="co">#&gt; 245 108  69 285   5</span>

<span class="va">sim_state_pref</span><span class="op">$</span><span class="va">sim_waittime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">-</span> 
 <span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_rrtstartdate</span><span class="op">)</span>
<span class="va">sim_state_pref</span><span class="op">$</span><span class="va">sim_listtime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">-</span> 
                   <span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_sim_listdate</span><span class="op">)</span>
<span class="co">#hla_mismatch &lt;- sim_state_pref[, c("tx_misa", "tx_misb", "tx_misdr")]%&gt;% mutate_if(is.character, as.numeric)</span>
<span class="co">#table(rowSums(hla_mismatch))</span>

<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;        National National_round2           State </span>
<span class="co">#&gt;             266              13             834</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">donor_blgroup</span>, <span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_blgroup</span><span class="op">)</span>
<span class="co">#&gt;     </span>
<span class="co">#&gt;        A  AB   B   O</span>
<span class="co">#&gt;   A  389   5   0   0</span>
<span class="co">#&gt;   AB   0   9   0   0</span>
<span class="co">#&gt;   B    0   3 121   0</span>
<span class="co">#&gt;   O    4   5   6 571</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">sim_waittime</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.1041  2.9945  6.5425  6.1499  8.4548 17.6767</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_waittime</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.1671  2.9233  5.7178  6.0271  8.0904 19.8466</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">sim_listtime</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>
<span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="co">#&gt;  0.0000  0.4137  1.4356  2.1854  3.3562  9.9589</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_listtime</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>
<span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span class="co">#&gt;  0.005479  0.468493  1.509589  2.176211  3.290411 10.789041</span>

<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">sim_waittime</span>, <span class="va">rawdata</span><span class="op">$</span><span class="va">recip_waittime</span><span class="op">)</span>
<span class="co">#&gt; Warning in ks.test(sim_state_pref$sim_waittime, rawdata$recip_waittime): p-value</span>
<span class="co">#&gt; will be approximate in the presence of ties</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two-sample Kolmogorov-Smirnov test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  sim_state_pref$sim_waittime and rawdata$recip_waittime</span>
<span class="co">#&gt; D = 0.33324, p-value &lt; 2.2e-16</span>
<span class="co">#&gt; alternative hypothesis: two-sided</span>

<span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_waittime</span><span class="op">/</span><span class="fl">365</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">algorithm</span>,
               <span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>,
          <span class="va">mean</span><span class="op">)</span>
<span class="co">#&gt;            Group.1 Group.2        x</span>
<span class="co">#&gt; 1         National     NSW 5.544700</span>
<span class="co">#&gt; 2  National_round2     NSW 4.240487</span>
<span class="co">#&gt; 3            State     NSW 7.977387</span>
<span class="co">#&gt; 4         National     QLD 6.342857</span>
<span class="co">#&gt; 5  National_round2     QLD 1.720548</span>
<span class="co">#&gt; 6            State     QLD 4.792770</span>
<span class="co">#&gt; 7         National      SA 2.700761</span>
<span class="co">#&gt; 8  National_round2      SA 2.164384</span>
<span class="co">#&gt; 9            State      SA 4.304810</span>
<span class="co">#&gt; 10        National     VIC 4.810619</span>
<span class="co">#&gt; 11 National_round2     VIC 4.873973</span>
<span class="co">#&gt; 12           State     VIC 6.257266</span>
<span class="co">#&gt; 13           State      WA 7.189824</span>

<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">sim_listtime</span>, <span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_listtime</span><span class="op">)</span>
<span class="co">#&gt; Warning in ks.test(sim_state_pref$sim_listtime, sim_state_pref$recip_listtime):</span>
<span class="co">#&gt; p-value will be approximate in the presence of ties</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two-sample Kolmogorov-Smirnov test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  sim_state_pref$sim_listtime and sim_state_pref$recip_listtime</span>
<span class="co">#&gt; D = 0.056604, p-value = 0.05653</span>
<span class="co">#&gt; alternative hypothesis: two-sided</span>

<span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_listtime</span><span class="op">/</span><span class="fl">365</span>,
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">algorithm</span>,
               <span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>,
          <span class="va">mean</span><span class="op">)</span>
<span class="co">#&gt;            Group.1 Group.2         x</span>
<span class="co">#&gt; 1         National     NSW 2.7249526</span>
<span class="co">#&gt; 2  National_round2     NSW 3.0770167</span>
<span class="co">#&gt; 3            State     NSW 2.8875214</span>
<span class="co">#&gt; 4         National     QLD 2.6673190</span>
<span class="co">#&gt; 5  National_round2     QLD 1.4328767</span>
<span class="co">#&gt; 6            State     QLD 1.9457953</span>
<span class="co">#&gt; 7         National      SA 0.1467275</span>
<span class="co">#&gt; 8  National_round2      SA 0.2602740</span>
<span class="co">#&gt; 9            State      SA 0.8174734</span>
<span class="co">#&gt; 10        National     VIC 1.9577161</span>
<span class="co">#&gt; 11 National_round2     VIC 0.2684932</span>
<span class="co">#&gt; 12           State     VIC 2.0000000</span>
<span class="co">#&gt; 13           State      WA 1.5855186</span>


<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_state</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; NSW QLD  SA VIC  WA </span>
<span class="co">#&gt; 395 159 100 452   7</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dynamic_matrix_pref</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    799 obs. of  7 variables:</span>
<span class="co">#&gt;  $ date      : chr  "2008-10-17" "2008-10-21" "2008-10-31" "2008-11-13" ...</span>
<span class="co">#&gt;  $ donor_id  : chr  "D84252" "D948387" "D70291" "D60436" ...</span>
<span class="co">#&gt;  $ num_kidney: chr  "2" "1" "2" "1" ...</span>
<span class="co">#&gt;  $ before    : chr  "298" "302" "302" "304" ...</span>
<span class="co">#&gt;  $ exclude   : chr  "3" "1" "3" "4" ...</span>
<span class="co">#&gt;  $ include   : chr  "9" "2" "7" "8" ...</span>
<span class="co">#&gt;  $ after     : chr  "304" "303" "306" "308" ...</span>
<span class="va">dynamic_matrix_pref</span> <span class="op">&lt;-</span> <span class="va">dynamic_matrix_pref</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>before <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">before</span><span class="op">)</span>,after <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">after</span><span class="op">)</span>,
                                                        include <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">include</span><span class="op">)</span>,exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">exclude</span><span class="op">)</span><span class="op">)</span>
<span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">date</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d"</span> <span class="op">)</span>
<span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">tx_year</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">tx_date</span> <span class="op">)</span>

<span class="va">dynamic_matrix_pref</span><span class="op">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tx_date</span>, y<span class="op">=</span> <span class="va">after</span>, colour<span class="op">=</span><span class="va">include</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_count.html">geom_count</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">tx_year</span>, <span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">num_kidney</span><span class="op">)</span> 
<span class="co">#&gt;       </span>
<span class="co">#&gt;         1  2</span>
<span class="co">#&gt;   2008  2 10</span>
<span class="co">#&gt;   2009 17 36</span>
<span class="co">#&gt;   2010 23 52</span>
<span class="co">#&gt;   2011 28 52</span>
<span class="co">#&gt;   2012 16 57</span>
<span class="co">#&gt;   2013 18 61</span>
<span class="co">#&gt;   2014 29 62</span>
<span class="co">#&gt;   2015 29 79</span>
<span class="co">#&gt;   2016 30 90</span>
<span class="co">#&gt;   2017 23 85</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">tx_year</span>, <span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">num_kidney</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">tx_year</span>, <span class="va">dynamic_matrix_pref</span><span class="op">$</span><span class="va">num_kidney</span><span class="op">)</span> <span class="op">)</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt;                1         2</span>
<span class="co">#&gt;   2008 0.1666667 0.8333333</span>
<span class="co">#&gt;   2009 0.3207547 0.6792453</span>
<span class="co">#&gt;   2010 0.3066667 0.6933333</span>
<span class="co">#&gt;   2011 0.3500000 0.6500000</span>
<span class="co">#&gt;   2012 0.2191781 0.7808219</span>
<span class="co">#&gt;   2013 0.2278481 0.7721519</span>
<span class="co">#&gt;   2014 0.3186813 0.6813187</span>
<span class="co">#&gt;   2015 0.2685185 0.7314815</span>
<span class="co">#&gt;   2016 0.2500000 0.7500000</span>
<span class="co">#&gt;   2017 0.2129630 0.7870370</span></code></pre></div>
</div>
<div id="plots-1" class="section level3">
<h3 class="hasAnchor">
<a href="#plots-1" class="anchor"></a>plots</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R">


<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; No id variables; using all as measure variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>recip_listtime <span class="op">=</span> <span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; No id variables; using all as measure variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>


<span class="va">pref_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; No id variables; using all as measure variables</span>
<span class="va">pref_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">pref_df</span><span class="op">$</span><span class="va">variable</span>,
                                    from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span>,
                                    to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pref_sim_listtime"</span>, 
                                           <span class="st">"pref_recip_listtime"</span><span class="op">)</span><span class="op">)</span>


<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span>, <span class="va">pref_df</span><span class="op">)</span>

<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">/</span><span class="fl">365</span>, 
                     color <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_color_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"listing time (Year)"</span><span class="op">)</span>

<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">value</span><span class="op">/</span><span class="fl">365</span>, 
                     x <span class="op">=</span> <span class="va">variable</span>,
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (Year)"</span><span class="op">)</span>
<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, ncol <span class="op">=</span> <span class="fl">2</span>, align <span class="op">=</span> <span class="st">"hv"</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-25-1.png" width="768"></p>
<p>Blood group</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_blgroup"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_blgroup as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_blgroup"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_blgroup as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_blgroup</span>, y <span class="op">=</span> <span class="va">value</span>, 
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"weighted sampling"</span><span class="op">)</span>



<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_blgroup"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_blgroup as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_blgroup"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_blgroup as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>
<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_blgroup</span>, y <span class="op">=</span> <span class="va">value</span>, 
                          fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sdm1"</span><span class="op">)</span>




<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g3</span>,  ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span>, align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-26-1.png" width="768"></p>
<p>Recipient State</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_state"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_state"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_state</span>, y <span class="op">=</span> <span class="va">value</span>, 
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"weighted sampling"</span><span class="op">)</span>





<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_state"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_state"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>
<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_state</span>, y <span class="op">=</span> <span class="va">value</span>, 
                          fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sdm1"</span><span class="op">)</span>




<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g3</span>,ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span><span class="fl">1</span>, align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-27-1.png" width="768"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_state"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span>, <span class="st">"algorithm"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state, algorithm as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_state"</span>, <span class="st">"recip_listtime"</span>, <span class="st">"recip_algorithm"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state, recip_algorithm as id variables</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"algorithm"</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_state</span>, y <span class="op">=</span> <span class="va">value</span>, 
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">algorithm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"weighted sampling"</span><span class="op">)</span>



<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"recip_state"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span>, <span class="st">"algorithm"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state, algorithm as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"recip_state"</span>, <span class="st">"recip_listtime"</span>, <span class="st">"recip_algorithm"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using recip_state, recip_algorithm as id variables</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">all_df</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"algorithm"</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>
<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">recip_state</span>, y <span class="op">=</span> <span class="va">value</span>, 
                          fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">algorithm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sdm1"</span><span class="op">)</span>




<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g3</span>,ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span>,
          align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-28-1.png" width="768"></p>
<p>PRA group</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pra_group"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using pra_group as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"pra_group"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using pra_group as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pra_group</span>, y <span class="op">=</span> <span class="va">value</span>, 
                     fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"weighted sampling"</span><span class="op">)</span>



<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pra_group"</span>, <span class="st">"sim_listtime"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Using pra_group as id variables</span>
<span class="va">all_df</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">raw_recip_matrix</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"pra_group"</span>, <span class="st">"recip_listtime"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Using pra_group as id variables</span>
<span class="va">all_df</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"raw_recip_listtime"</span>
<span class="va">df_pref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="va">all_df</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df_pref</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pra_group</span>, y <span class="op">=</span> <span class="va">value</span>, 
                          fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"listing time (days)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"sdm1 "</span><span class="op">)</span>



<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g3</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">1</span>, align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-29-1.png" width="768"></p>
<p>Algorithm Proportions</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="va">d2</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"sim"</span><span class="op">)</span>, 
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">$</span><span class="va">recip_algorithm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_subset</span><span class="op">)</span>,type<span class="op">=</span> <span class="st">"actual"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">d2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">d2</span>, algorithm<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"type"</span>, <span class="st">"algorithm"</span><span class="op">)</span> 
<span class="va">d2</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">d2</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">g2</span> <span class="op">=</span> <span class="va">d2</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">algorithm</span>, y<span class="op">=</span> <span class="va">n</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"Weighted sampling"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> 

<span class="va">d3</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">algorithm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"sim"</span><span class="op">)</span>, 
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">$</span><span class="va">recip_algorithm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim_state_pref</span><span class="op">)</span>,type<span class="op">=</span> <span class="st">"actual"</span><span class="op">)</span><span class="op">)</span> 
<span class="va">d3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">d3</span>, algorithm<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">d3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">d3</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"type"</span>, <span class="st">"algorithm"</span><span class="op">)</span> 
<span class="va">d3</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">d3</span><span class="op">$</span><span class="va">n</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">g3</span> <span class="op">=</span> <span class="va">d3</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">algorithm</span>, y<span class="op">=</span> <span class="va">n</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span> title <span class="op">=</span> <span class="st">"sdm1"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/scale_color_tableau.html">scale_fill_tableau</a></span><span class="op">(</span><span class="op">)</span> 



<span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span><span class="op">(</span><span class="va">g2</span>, <span class="va">g3</span>, ncol <span class="op">=</span> <span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">2</span>,
          align <span class="op">=</span> <span class="st">"hv"</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="example1_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
<p>Also a quote using <code><a href="https://rdrr.io/r/base/Comparison.html">&gt;</a></code>:</p>
<blockquote>
<p>“He who gives up [code] safety for [code] speed deserves neither.” (<a href="https://twitter.com/hadleywickham/status/504368538874703872">via</a>)</p>
</blockquote>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
